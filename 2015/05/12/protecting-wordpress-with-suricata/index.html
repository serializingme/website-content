<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#" class="bg-dark">
  <head>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#ffffff" />


<meta property="title" content="Protecting WordPress with Suricata - SerializingMe" />


  
<meta name="description" content="Adding a full featured IDPS solution, is a good step in protecting not only that &#34;all too many times vulnerable&#34; WordPress installation..." />
  
  
    
    
<meta name="keywords" content="LEMP,Suricata,WordPress" />
    
  


<meta name="author" content="Duarte Silva" />



<meta itemprop="title" content="Protecting WordPress with Suricata - SerializingMe" />


  
<meta itemprop="description" content="Adding a full featured IDPS solution, is a good step in protecting not only that &#34;all too many times vulnerable&#34; WordPress installation..." />
  
  
<meta itemprop="image" content="https://www.serializing.me/uploads/2015/05/suricata-config.png" />
  
  
    
    
<meta itemprop="keywords" content="LEMP,Suricata,WordPress" />
    
  
  
<meta itemprop="wordCount" content="1061" />
  



<meta property="og:title" content="Protecting WordPress with Suricata - SerializingMe" />


  
<meta property="og:type" content="article" />
  
  
<meta property="og:description" content="Adding a full featured IDPS solution, is a good step in protecting not only that &#34;all too many times vulnerable&#34; WordPress installation..." />
  
  
<meta property="og:image" content="https://www.serializing.me/uploads/2015/05/suricata-config.png" />
  


<meta property="og:url" content="https://www.serializing.me/2015/05/12/protecting-wordpress-with-suricata/" />


<meta property="og:site_name" content="SerializingMe" />



  
<meta name="twitter:card" content="summary_large_image" />
  



<meta name="twitter:title" content="Protecting WordPress with Suricata - SerializingMe" />


<meta name="twitter:url" content="https://www.serializing.me/2015/05/12/protecting-wordpress-with-suricata/" />


  
<meta name="twitter:description" content="Adding a full featured IDPS solution, is a good step in protecting not only that &#34;all too many times vulnerable&#34; WordPress installation..." />
  
  
<meta name="twitter:image" content="https://www.serializing.me/uploads/2015/05/suricata-config.png" />
  


<title>Protecting WordPress with Suricata - SerializingMe</title>
<link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<link rel="manifest" href="https://www.serializing.me/manifest.json">
<link rel="mask-icon" href="https://www.serializing.me/safari-pinned-tab.svg" color="#5bbad5">

<link href="https://www.serializing.me/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Combined Feed" />
<link href="https://www.serializing.me/page/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Pages Feed" />
<link href="https://www.serializing.me/post/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Posts Feed" />
<link href="https://www.serializing.me/project/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Projects Feed" />

<link href="https://www.serializing.me/css/bootstrap-reboot.min.css" rel="stylesheet" />
<link href="https://www.serializing.me/css/bootstrap.min.css" rel="stylesheet" /><link href="https://www.serializing.me/css/serializingme.min.css" rel="stylesheet" />

  </head>
  <body>
    <header>
<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
  <div class="container">
    <a class="navbar-brand" href="https://www.serializing.me/">
      <img src="/brand.png" width="30" height="30" class="d-inline-block align-top" /> SerializingMe
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav ml-auto">


        <li class="nav-item "><a class="nav-link" title="Blog" href="https://www.serializing.me/post/">Blog</a></li>

        <li class="nav-item "><a class="nav-link" title="Projects" href="https://www.serializing.me/project/">Projects</a></li>

        <li class="nav-item "><a class="nav-link" title="Contributions" href="https://www.serializing.me/contributions/">Contributions</a></li>

        <li class="nav-item "><a class="nav-link" title="About" href="https://www.serializing.me/about/">About</a></li>

      </ul>
    </div>
  </div>
</nav>
<noscript>
  <div class="container mt-2 mb-0">
    <div class="alert alert-danger">JavaScript is disabled, this site will not work properly without it.</div>
  </div>
</noscript>

    </header>
    <section class="container">


  <div class="row">
  
  <div class="col-lg-8">
    
    <div class="card mb-4 my-4"><img class="card-img-top" src="/uploads/2015/05/suricata-config.png" alt="Protecting WordPress with Suricata" /><div class="card-body">
        <h2 class="card-title">
Protecting WordPress with Suricata
        </h2>
        <div class="text-justify">
<p>There aren&rsquo;t any silver bullets that will protect a WordPress installation against every single attack, but adding a full featured IDPS solution like Suricata, is a good step in protecting not only that &ldquo;all too many times vulnerable&rdquo; WordPress installation but also other services like SSH.</p>
<p>Most WordPress installations are run as a single machine with a complete middleware stack from the web server down to the database. As such, what follows, is based on the following assumptions:</p>
<ul>
<li>Middleware stack is already installed, fully functional and based on LEMP</li>
<li>OS is Enterprise Linux 7 based (minimum version for the Linux Kernel is 3.14)</li>
<li>HTTP traffic is received using TLS</li>
<li>Nftables user space tools are installed</li>
<li>Suricata is already installed (minimum version is 2.1beta3)</li>
<li>ETOpen rule set as been installed in order for Suricata to use it</li>
<li>Everything is running in the same host</li>
<li>The host is a dedicated server or a VPS</li>
</ul>
<div class="alert alert-warning"><span><i class="fas fa-exclamation-triangle"></i>&nbsp;</span>There are some VPS&rsquo;s, mostly those based on OpenVZ, that will not allow for Kernel changes. Check with the current or future VPS provider before hand.</div>
<p>The first step is to replace the location section of the server block that listens to HTTPS and passes the requests to PHP, in order to reverse proxy them instead.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span># Replace the following
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span>location ~ \.php$ {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span>  (...)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span># With
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span>location / {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span>  proxy_set_header X-Real-IP $remote_addr;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span>  proxy_set_header X-Forwarded-Host $server_name;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span>  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span>  proxy_set_header X-Forwarded-Proto $scheme;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span>  proxy_pass http://localhost;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span>}
</code></pre></div><div class="alert alert-danger"><span><i class="fas fa-minus-circle"></i>&nbsp;</span>Do not use the <code>$host</code> variable in the header <code>X-Forwarded-Host</code> since its client/attacker controlled, possibly making your WordPress installation susceptible to host header poisoning. Use the <code>$server_name</code> variable instead.</div>
<p>Next we need to configure Nginx to listen locally for the decrypted traffic and to pass it to PHP.</p>
<div class="alert alert-warning"><span><i class="fas fa-exclamation-triangle"></i>&nbsp;</span>The WordPress installation will need to be configured for a reverse proxy environment and paths may need to be adjusted depending on the reader specific WordPress installation.</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span>server {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span>  listen localhost:80 default_server;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span>  # WordPress installation root directory
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span>  root /usr/share/nginx/html;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span>  # Index files
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span>  index index.php;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span>  # Make nginx play nice with WordPress permanent links
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span>  location / {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span>    try_files $uri $uri/ /index.php?$args;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span>  }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">15</span>  # Pass the requests to PHP
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">16</span>  location ~ \.php$ {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">17</span>    (...)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">18</span>  }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">19</span>}
</code></pre></div><p>After checking that the configuration is correct, restart Nginx. From this point onwards, there should be plain text HTTP traffic flowing to the socket listening locally (generate some traffic if needed). You can confirm this, by using <code>tcpdump</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2</span><span style="color:#cd2828;font-weight:bold"></span>tcpdump -i lo <span style="color:#ed9d13">&#34;port 80&#34;</span>
</code></pre></div><p>The next step is to configure Netfilter using Nftables, in order for it to send traffic to Suricata. To do that, create a file with the <code>rules</code> extension under <code>/etc/nftables/</code> directory.</p>
<div class="alert alert-info"><span><i class="fas fa-info-circle"></i>&nbsp;</span>If Nftables is already configured in the system, edit the existing rules by adding the IPS related chains with a priority lower than the ones used for the firewall (the higher the number the lower the priority).</div>
<div class="alert alert-warning"><span><i class="fas fa-exclamation-triangle"></i>&nbsp;</span>The following configuration only takes into account IPv4, for IPv6 extra configurations will be needed.</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span>#!/usr/sbin/nft -f
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span>table ip filter {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span>  # Firewall
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span>  chain firewall-input {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span>    type filter hook input priority 0;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span>    (...)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span>  }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span>  chain firewall-output {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span>    type filter hook output priority 0;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span>    (...)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span>  }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span>  # IPS
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span>  chain ips-input {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14</span>    type filter hook input priority 10;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">15</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">16</span>    # Queue input packets to Suricata
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">17</span>    counter queue num 0-1 fanout, bypass
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">18</span>  }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">19</span>  chain ips-output {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">20</span>    type filter hook output priority 10;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">21</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">22</span>    # Queue output packets to Suricata
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">23</span>    counter queue num 0-1 fanout, bypass
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">24</span>  }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">25</span>}
</code></pre></div><div class="alert alert-warning"><span><i class="fas fa-exclamation-triangle"></i>&nbsp;</span>Make sure <code>firewalld</code> is disabled.</div>
<p>After starting the Nftables service, the next step is to configure Suricata. First edit the main Suricata configuration file (<code>/etc/suricata/suricata.yaml</code>).</p>
<p><div class="alert alert-info"><span><i class="fas fa-info-circle"></i>&nbsp;</span>The Netfilter queue fail open setting may have performance impacts, be sure to read Suricata documentation on it.</div>
<div class="alert alert-warning"><span><i class="fas fa-exclamation-triangle"></i>&nbsp;</span>The Suricata configurations, are for a host with two CPU&rsquo;s, as such, affinity settings and the number of queues that Suricata listens to may need to be adjusted.</div></p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span><span style="color:#999;font-style:italic"># Activate workers run mode</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">runmode</span>:<span style="color:#666"> </span>workers<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span><span style="color:#666"></span><span style="color:#999;font-style:italic"># Enable EVE logging with X-Forward-For support</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span><span style="color:#666"></span>- <span style="color:#6ab825;font-weight:bold">eve-log</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">enabled</span>:<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">yes</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span><span style="color:#666">    </span><span style="color:#999;font-style:italic"># ...</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">types</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span><span style="color:#666">      </span>- <span style="color:#6ab825;font-weight:bold">alert</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span><span style="color:#666">          </span><span style="color:#999;font-style:italic"># ...</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span><span style="color:#666">          </span><span style="color:#6ab825;font-weight:bold">xff</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span><span style="color:#666">            </span><span style="color:#6ab825;font-weight:bold">enabled</span>:<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">yes</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span><span style="color:#666">            </span><span style="color:#999;font-style:italic"># Two operation modes are available, &#34;extra-data&#34; and &#34;overwrite&#34;.</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14</span><span style="color:#666">            </span><span style="color:#6ab825;font-weight:bold">mode</span>:<span style="color:#666"> </span>overwrite<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">15</span><span style="color:#666">            </span><span style="color:#999;font-style:italic"># Two proxy deployments are supported, &#34;reverse&#34; and &#34;forward&#34;. In</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">16</span><span style="color:#666">            </span><span style="color:#999;font-style:italic"># a &#34;reverse&#34; deployment the IP address used is the last one, in a</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">17</span><span style="color:#666">            </span><span style="color:#999;font-style:italic"># &#34;forward&#34; deployment the first IP address is used.</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">18</span><span style="color:#666">            </span><span style="color:#6ab825;font-weight:bold">deployment</span>:<span style="color:#666"> </span>reverse<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">19</span><span style="color:#666">            </span><span style="color:#999;font-style:italic"># Header name where the actual IP address will be reported, if more</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">20</span><span style="color:#666">            </span><span style="color:#999;font-style:italic"># than one IP address is present, the last IP address will be the</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">21</span><span style="color:#666">            </span><span style="color:#999;font-style:italic"># one taken into consideration.</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">22</span><span style="color:#666">            </span><span style="color:#6ab825;font-weight:bold">header</span>:<span style="color:#666"> </span>X-Forwarded-For<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">23</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">24</span><span style="color:#666"></span><span style="color:#999;font-style:italic"># Disable Netfilter queue fail open</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">25</span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">nfq</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">26</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">fail-open</span>:<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">no</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">27</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">28</span><span style="color:#666"></span><span style="color:#999;font-style:italic"># Configure CPU affinity</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">29</span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">threading</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">30</span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># ...</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">31</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">set-cpu-affinity</span>:<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">yes</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">32</span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># Tune cpu affinity of suricata threads. Each family of threads can be bound</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">33</span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># on specific CPUs.</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">34</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">cpu-affinity</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">35</span><span style="color:#666">    </span>- <span style="color:#6ab825;font-weight:bold">management-cpu-set</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">36</span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">cpu</span>:<span style="color:#666"> </span>[<span style="color:#666"> </span><span style="color:#3677a9">0</span>,<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666"> </span>]<span style="color:#666">  </span><span style="color:#999;font-style:italic"># include only these cpus in affinity settings</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">37</span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">mode</span>:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;balanced&#34;</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">38</span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">prio</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">39</span><span style="color:#666">          </span><span style="color:#6ab825;font-weight:bold">default</span>:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;high&#34;</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">40</span><span style="color:#666">    </span><span style="color:#999;font-style:italic"># ...</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">41</span><span style="color:#666">    </span>- <span style="color:#6ab825;font-weight:bold">detect-cpu-set</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">42</span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">cpu</span>:<span style="color:#666"> </span>[<span style="color:#666"> </span><span style="color:#3677a9">0</span>,<span style="color:#666"> </span><span style="color:#3677a9">1</span><span style="color:#666"> </span>]<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">43</span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">mode</span>:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;exclusive&#34;</span><span style="color:#666"> </span><span style="color:#999;font-style:italic"># run detect threads in these cpus</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">44</span><span style="color:#666">        </span><span style="color:#999;font-style:italic"># Use explicitely 3 threads and don&#39;t compute number by using</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">45</span><span style="color:#666">        </span><span style="color:#999;font-style:italic"># detect-thread-ratio variable:</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">46</span><span style="color:#666">        </span><span style="color:#999;font-style:italic"># threads: 3</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">47</span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">prio</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">48</span><span style="color:#666">          </span><span style="color:#999;font-style:italic"># low: [ 0 ]</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">49</span><span style="color:#666">          </span><span style="color:#999;font-style:italic"># medium: [ &#34;1-2&#34; ]</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">50</span><span style="color:#666">          </span><span style="color:#999;font-style:italic"># high: [ 3 ]</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">51</span><span style="color:#666">          </span><span style="color:#6ab825;font-weight:bold">default</span>:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;high&#34;</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">52</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">53</span><span style="color:#666"></span><span style="color:#999;font-style:italic"># Edit the HOME_NET to contain the localhost address</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">54</span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">vars</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">55</span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># ...</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">56</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">address-groups</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">57</span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">HOME_NET</span>:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;[127.0.0.1,(...)]&#34;</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">58</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">59</span><span style="color:#666"></span><span style="color:#999;font-style:italic"># Edit the host OS policy to contain the localhost address</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">60</span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">host-os-policy</span>:<span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">61</span><span style="color:#666">  </span><span style="color:#999;font-style:italic"># ...</span><span style="color:#666">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">62</span><span style="color:#666">  </span><span style="color:#6ab825;font-weight:bold">linux</span>:<span style="color:#666"> </span>[<span style="color:#3677a9">127.0.0.1</span>]<span style="color:#666">
</span></code></pre></div><p>Second, edit the system Suricata configuration file (<code>/etc/sysconfig/suricata</code>).</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span><span style="color:#999;font-style:italic"># Make Suricata listen for packets in the Netfilter queues</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2</span><span style="color:#40ffff">OPTIONS</span>=<span style="color:#ed9d13">&#34;-q 0 -q 1 &#34;</span>
</code></pre></div><p>After starting Suricata, check that everything worked out without errors and that packets are being received (check the <code>/var/log/suricata/stats.log</code> file). To test the installation, use the following SQLi vector.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span>https://external.domain/?p=&#39;)) UNION SELECT 1--
</code></pre></div><p>If everything worked as planned, Suricata should have created an entry in the EVE log (<code>/var/log/suricata/eve.json</code>) reporting the attack.</p>
<div class="alert alert-info"><span><i class="fas fa-info-circle"></i>&nbsp;</span>Configuring the ETOpen rule set can be easily done using <em>Oinkmaster</em>.</div>
<p>The next step is to configure the rules to disable false positives:</p>
<ul>
<li><code>2003508</code> - <code>ET WEB_SPECIFIC_APPS WordPress wp-login.php redirect_to credentials stealing attempt</code></li>
<li><code>2012843</code> - <code>ET POLICY Cleartext WordPress Login</code></li>
<li><code>2012998</code> - <code>ET WEB_SERVER PHP Possible https Local File Inclusion Attempt</code></li>
<li><code>2013505</code> - <code>ET POLICY GNU\Linux YUM User-Agent Outbound likely related to package management</code></li>
</ul>
<p>And change some useful rules from <code>alert</code> to <code>drop</code>:</p>
<ul>
<li><code>2001219</code> - <code>ET SCAN Potential SSH Scan</code></li>
<li><code>2006546</code> - <code>ET SCAN LibSSH Based Frequent SSH Connections Likely BruteForce Attack</code></li>
<li><code>2019876</code> - <code>ET SCAN SSH BruteForce Tool with fake PUTTY version</code></li>
<li>Every rule from:
<ul>
<li><code>ciarmy.rules</code></li>
<li><code>compromised.rules</code></li>
<li><code>drop.rules</code></li>
<li><code>dshield.rules</code></li>
<li><code>emerging-web_server.rules</code></li>
<li><code>emerging-web_specific_apps.rules</code></li>
</ul>
</li>
</ul>
<p>Restart Suricata and that&rsquo;s it. It&rsquo;s a good idea to update the rules every now and then so that Suricata can better protect WordPress :)</p></div>
      </div>
      <div class="card-footer">
<span><i class="fas fa-calendar-alt"></i>&nbsp;</span>May 12, 2015&nbsp;&nbsp;<br/>
<span><i class="fas fa-folder-open"></i>&nbsp;</span><a href="https://www.serializing.me/categories/configuration/">Configuration</a>,&nbsp;<a href="https://www.serializing.me/categories/linux/">Linux</a>,&nbsp;<a href="https://www.serializing.me/categories/network/">Network</a>&nbsp;&nbsp;<br/>
<span><i class="fas fa-tag"></i>&nbsp;</span><a href="https://www.serializing.me/tags/lemp/">LEMP</a>,&nbsp;<a href="https://www.serializing.me/tags/suricata/">Suricata</a>,&nbsp;<a href="https://www.serializing.me/tags/wordpress/">WordPress</a>
      </div>
    </div>
    <ul class="pagination justify-content-center mb-4"><li class="page-item">
        <a href="https://www.serializing.me/2015/05/28/a-paranoid-fish-and-silver-bullets/" title="A Paranoid Fish and Silver Bullets" class="page-link"><span><i class="fas fa-chevron-left"></i>&nbsp;</span>Newer</a>
      </li><li class="page-item">
    <a href="https://www.serializing.me/2015/05/03/check-my-cv-generating-yara-rules/" title="&#34;Check my CV&#34;, Generating YARA Rules" class="page-link">Older<span>&nbsp;<i class="fas fa-chevron-right"></i>&nbsp;</span></a>
  </li></ul>
  </div>
  
  <div class="col-md-4">
    
    <div class="card my-4">
      <h5 class="card-header">Categories</h5>
      <div class="card-body">
        <div class="cloud">
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/bug-bounty/" title="3 posts">bug-bounty</a>
<a style="font-size: 1.2307692307692308em" href="https://www.serializing.me/categories/case-study/" title="4 posts">case-study</a>
<a style="font-size: 1.5384615384615385em" href="https://www.serializing.me/categories/configuration/" title="8 posts">configuration</a>
<a style="font-size: 1.0769230769230769em" href="https://www.serializing.me/categories/cve/" title="2 posts">cve</a>
<a style="font-size: 1em" href="https://www.serializing.me/categories/encryption/" title="1 posts">encryption</a>
<a style="font-size: 1.3076923076923077em" href="https://www.serializing.me/categories/exploit/" title="5 posts">exploit</a>
<a style="font-size: 1.2307692307692308em" href="https://www.serializing.me/categories/hardware-hacking/" title="4 posts">hardware-hacking</a>
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/incident-response/" title="3 posts">incident-response</a>
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/learning/" title="3 posts">learning</a>
<a style="font-size: 1.8461538461538463em" href="https://www.serializing.me/categories/linux/" title="12 posts">linux</a>
<a style="font-size: 1.3076923076923077em" href="https://www.serializing.me/categories/malware/" title="5 posts">malware</a>
<a style="font-size: 1em" href="https://www.serializing.me/categories/memory-forensics/" title="1 posts">memory-forensics</a>
<a style="font-size: 1.5384615384615385em" href="https://www.serializing.me/categories/network/" title="8 posts">network</a>
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/reconnaissance/" title="3 posts">reconnaissance</a>
<a style="font-size: 1.9230769230769231em" href="https://www.serializing.me/categories/reverse-engineering/" title="13 posts">reverse-engineering</a>
<a style="font-size: 1.2307692307692308em" href="https://www.serializing.me/categories/virtualization/" title="4 posts">virtualization</a>
<a style="font-size: 2em" href="https://www.serializing.me/categories/windows/" title="14 posts">windows</a>


        </div>
      </div>
    </div>
    
    <div class="card my-4">
      <h5 class="card-header">Tags</h5>
      <div class="card-body">
        <div class="cloud">
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/active-directory/" title="3 posts">active-directory</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/acunetix-wvs/" title="1 posts">acunetix-wvs</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/android/" title="1 posts">android</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/applocker/" title="2 posts">applocker</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/aruba-networks/" title="2 posts">aruba-networks</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/attck/" title="1 posts">attck</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/banking/" title="1 posts">banking</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/bios/" title="1 posts">bios</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/brute-force/" title="1 posts">brute-force</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/bugcrowd/" title="3 posts">bugcrowd</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/cac-ipc/" title="3 posts">cac-ipc</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/cheat/" title="1 posts">cheat</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/cisco-anyconnect/" title="3 posts">cisco-anyconnect</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/code-injection/" title="1 posts">code-injection</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/csharp/" title="1 posts">csharp</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/cuckoo-sandbox/" title="2 posts">cuckoo-sandbox</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/e-gpu/" title="1 posts">e-gpu</a>
<a style="font-size: 1.75em" href="https://www.serializing.me/tags/emofishes/" title="4 posts">emofishes</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/emotions/" title="3 posts">emotions</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/fireeye/" title="3 posts">fireeye</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/gpo-bypass/" title="1 posts">gpo-bypass</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/group-policy-objects/" title="1 posts">group-policy-objects</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/honeypot/" title="1 posts">honeypot</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hook-functions/" title="1 posts">hook-functions</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hp/" title="1 posts">hp</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hpqpswdd/" title="1 posts">hpqpswdd</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hugo/" title="1 posts">hugo</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/ivre/" title="1 posts">ivre</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/lemp/" title="2 posts">lemp</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/metasploit/" title="1 posts">metasploit</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/paranoid-fish/" title="3 posts">paranoid-fish</a>
<a style="font-size: 1.75em" href="https://www.serializing.me/tags/passwords/" title="4 posts">passwords</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/portuguese/" title="2 posts">portuguese</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/powascripts/" title="3 posts">powascripts</a>
<a style="font-size: 1.75em" href="https://www.serializing.me/tags/powershell/" title="4 posts">powershell</a>
<a style="font-size: 2em" href="https://www.serializing.me/tags/qemu/" title="5 posts">qemu</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/raspberry-pi/" title="1 posts">raspberry-pi</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/razer/" title="1 posts">razer</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/red-team/" title="1 posts">red-team</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/soho/" title="3 posts">soho</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/ssh/" title="1 posts">ssh</a>
<a style="font-size: 2em" href="https://www.serializing.me/tags/suricata/" title="5 posts">suricata</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/technicolor/" title="3 posts">technicolor</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/titan-quest/" title="1 posts">titan-quest</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/tls/" title="1 posts">tls</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/tq-invincible/" title="1 posts">tq-invincible</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/usb/" title="1 posts">usb</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/virtualbox/" title="3 posts">virtualbox</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/volatility/" title="1 posts">volatility</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/wordpress/" title="3 posts">wordpress</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/yara/" title="1 posts">yara</a>


        </div>
      </div>
    </div>
  </div>
</div>



    </section>
    <footer class="mt-4 bg-dark">
<div class="container">
  <div class="row text-center">
  <div class="col-12 col-md my-4">
    <ul class="list-inline">

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://infosec.exchange/@serializingme" title="Mastodon">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-mastodon fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://www.twitch.tv/serializingme" title="Twitch">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-twitch fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://discord.gg/NS5qHT4" title="Discord">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-discord fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://www.youtube.com/serializingme" title="YouTube">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-youtube fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://github.com/serializingme" title="GitHub">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-github fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://bugcrowd.com/serializingme" title="Bugcrowd">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fas fa-bug fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://twitter.com/serializingme" title="Twitter">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-twitter fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

    </ul>
      <ul class="list-inline">

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-copyright"></i>&nbsp;</span><a class="footer-link text-light" href="/licensing/" title="Licensing">Licensing</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-eye"></i>&nbsp;</span><a class="footer-link text-light" href="/privacy/" title="Privacy">Privacy</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-shield-alt"></i>&nbsp;</span><a class="footer-link text-light" href="/security/" title="Security">Security</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-envelope"></i>&nbsp;</span><a class="footer-link text-light" href="/contacts/" title="Contacts">Contacts</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-rss"></i>&nbsp;</span><a class="footer-link text-light" href="/feeds/" title="Feeds">Feeds</a>
    </li>

  </ul>
  <small class="d-block mb-3 text-muted">&copy;&nbsp;2023&nbsp;Duarte Silva</small>
  </div>
</div>
</div>

    </footer>
<script src="https://www.serializing.me/js/jquery.min.js"></script>
<script src="https://www.serializing.me/js/bootstrap.min.js"></script>
<script src="https://www.serializing.me/js/fontawesome-solid.min.js"></script>
<script src="https://www.serializing.me/js/fontawesome-brands.min.js"></script>
<script src="https://www.serializing.me/js/fontawesome.min.js"></script><script src="https://www.serializing.me/js/serializingme.min.js"></script>
  </body>
</html>
