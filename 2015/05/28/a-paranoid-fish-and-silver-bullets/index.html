<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#" class="bg-dark">
  <head>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#ffffff" />


<meta property="title" content="A Paranoid Fish and Silver Bullets - SerializingMe" />


  
<meta name="description" content="Paranoid Fish and Silver Bullets, a look at FireEye and Cuckoo sandbox verus Pafish..." />
  
  
    
    
<meta name="keywords" content="Cuckoo Sandbox,Emofishes,FireEye,Paranoid Fish,QEMU,VirtualBox" />
    
  


<meta name="author" content="Duarte Silva" />



<meta itemprop="title" content="A Paranoid Fish and Silver Bullets - SerializingMe" />


  
<meta itemprop="description" content="Paranoid Fish and Silver Bullets, a look at FireEye and Cuckoo sandbox verus Pafish..." />
  
  
<meta itemprop="image" content="https://www.serializing.me/uploads/2015/05/pafish-virtualbox.png" />
  
  
    
    
<meta itemprop="keywords" content="Cuckoo Sandbox,Emofishes,FireEye,Paranoid Fish,QEMU,VirtualBox" />
    
  
  
<meta itemprop="wordCount" content="250" />
  



<meta property="og:title" content="A Paranoid Fish and Silver Bullets - SerializingMe" />


  
<meta property="og:type" content="article" />
  
  
<meta property="og:description" content="Paranoid Fish and Silver Bullets, a look at FireEye and Cuckoo sandbox verus Pafish..." />
  
  
<meta property="og:image" content="https://www.serializing.me/uploads/2015/05/pafish-virtualbox.png" />
  


<meta property="og:url" content="https://www.serializing.me/2015/05/28/a-paranoid-fish-and-silver-bullets/" />


<meta property="og:site_name" content="SerializingMe" />



  
<meta name="twitter:card" content="summary_large_image" />
  



<meta name="twitter:title" content="A Paranoid Fish and Silver Bullets - SerializingMe" />


<meta name="twitter:url" content="https://www.serializing.me/2015/05/28/a-paranoid-fish-and-silver-bullets/" />


  
<meta name="twitter:description" content="Paranoid Fish and Silver Bullets, a look at FireEye and Cuckoo sandbox verus Pafish..." />
  
  
<meta name="twitter:image" content="https://www.serializing.me/uploads/2015/05/pafish-virtualbox.png" />
  


<title>A Paranoid Fish and Silver Bullets - SerializingMe</title>
<link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<link rel="manifest" href="https://www.serializing.me/manifest.json">
<link rel="mask-icon" href="https://www.serializing.me/safari-pinned-tab.svg" color="#5bbad5">

<link href="https://www.serializing.me/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Combined Feed" />
<link href="https://www.serializing.me/page/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Pages Feed" />
<link href="https://www.serializing.me/post/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Posts Feed" />
<link href="https://www.serializing.me/project/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Projects Feed" />

<link href="https://www.serializing.me/css/bootstrap-reboot.min.css" rel="stylesheet" />
<link href="https://www.serializing.me/css/bootstrap.min.css" rel="stylesheet" /><link href="https://www.serializing.me/css/serializingme.min.css" rel="stylesheet" />

  </head>
  <body>
    <header>
<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
  <div class="container">
    <a class="navbar-brand" href="https://www.serializing.me/">
      <img src="/brand.png" width="30" height="30" class="d-inline-block align-top" /> SerializingMe
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav ml-auto">


        <li class="nav-item "><a class="nav-link" title="Blog" href="https://www.serializing.me/post/">Blog</a></li>

        <li class="nav-item "><a class="nav-link" title="Projects" href="https://www.serializing.me/project/">Projects</a></li>

        <li class="nav-item "><a class="nav-link" title="Contributions" href="https://www.serializing.me/contributions/">Contributions</a></li>

        <li class="nav-item "><a class="nav-link" title="About" href="https://www.serializing.me/about/">About</a></li>

      </ul>
    </div>
  </div>
</nav>
<noscript>
  <div class="container mt-2 mb-0">
    <div class="alert alert-danger">JavaScript is disabled, this site will not work properly without it.</div>
  </div>
</noscript>

    </header>
    <section class="container">


  <div class="row">
  
  <div class="col-lg-8">
    
    <div class="card mb-4 my-4"><img class="card-img-top" src="/uploads/2015/05/pafish-virtualbox.png" alt="A Paranoid Fish and Silver Bullets" /><div class="card-body">
        <h2 class="card-title">
A Paranoid Fish and Silver Bullets
        </h2>
        <div class="text-justify">
<p>I have been doing some research (and development) around virtualized malware sandboxes, being the question, &ldquo;how easy is for malware to detect such an environment&rdquo; the most important one, I turned to a tool called Pafish (Paranoid Fish).</p>
<p>Up until now, I have tested two malware execution sandboxes, one commercial and one open source. Interestingly enough, the commercial system is also based on a open source virtualization technology.</p>
<ul>
<li>FireEye (QEMU)</li>
<li>Cuckoo Sandbox (VirtualBox)</li>
</ul>
<p>FireEye failed to evade detection in three tests while Cuckoo Sandbox failed in many more tests. In between the two, FireEye is definitely the best evading detection from Pafish, but being the best isn&rsquo;t hard, since the Cuckoo Sandbox doesn&rsquo;t have countermeasures out-of-the-box. However, both of them, marked Pafish activities as malicious.</p>
<p>I have also submitted to both systems some malware samples (that try to detect virtualization) associated with the, still on going, DHL spam run targeting German speaking users. In all the samples the analysis in Cuckoo Sandbox was inconclusive. In FireEye, it was possible to review the full malicious behaviour of all the samples (including Command and Control communications).</p>
<p>In conclusion, there aren&rsquo;t any silver bullets, but FireEye is one of the good bullets. I guess it is possible to make Cuckoo Sandbox a lot more stealth due to it&rsquo;s Open Source and extensible nature and by using QEMU instead of VirtualBox.</p>
<p>Results from the research lead to some contributions to <a href="/contributions/" title="Open Source projects contributions">Pafish</a> with more to come in the near future as the research progresses :D</p></div>
      </div>
      <div class="card-footer">
<span><i class="fas fa-calendar-alt"></i>&nbsp;</span>May 28, 2015&nbsp;&nbsp;<br/>
<span><i class="fas fa-folder-open"></i>&nbsp;</span><a href="https://www.serializing.me/categories/malware/">Malware</a>,&nbsp;<a href="https://www.serializing.me/categories/virtualization/">Virtualization</a>,&nbsp;<a href="https://www.serializing.me/categories/windows/">Windows</a>&nbsp;&nbsp;<br/>
<span><i class="fas fa-tag"></i>&nbsp;</span><a href="https://www.serializing.me/tags/cuckoo-sandbox/">Cuckoo Sandbox</a>,&nbsp;<a href="https://www.serializing.me/tags/emofishes/">Emofishes</a>,&nbsp;<a href="https://www.serializing.me/tags/fireeye/">FireEye</a>,&nbsp;<a href="https://www.serializing.me/tags/paranoid-fish/">Paranoid Fish</a>,&nbsp;<a href="https://www.serializing.me/tags/qemu/">QEMU</a>,&nbsp;<a href="https://www.serializing.me/tags/virtualbox/">VirtualBox</a>
      </div>
    </div>
    <ul class="pagination justify-content-center mb-4"><li class="page-item">
        <a href="https://www.serializing.me/2015/06/02/reversing-arubaos-firmware/" title="Reversing ArubaOS Firmware" class="page-link"><span><i class="fas fa-chevron-left"></i>&nbsp;</span>Newer</a>
      </li><li class="page-item">
    <a href="https://www.serializing.me/2015/05/12/protecting-wordpress-with-suricata/" title="Protecting WordPress with Suricata" class="page-link">Older<span>&nbsp;<i class="fas fa-chevron-right"></i>&nbsp;</span></a>
  </li></ul>
  </div>
  
  <div class="col-md-4">
    
    <div class="card my-4">
      <h5 class="card-header">Categories</h5>
      <div class="card-body">
        <div class="cloud">
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/bug-bounty/" title="3 posts">bug-bounty</a>
<a style="font-size: 1.2307692307692308em" href="https://www.serializing.me/categories/case-study/" title="4 posts">case-study</a>
<a style="font-size: 1.5384615384615385em" href="https://www.serializing.me/categories/configuration/" title="8 posts">configuration</a>
<a style="font-size: 1.0769230769230769em" href="https://www.serializing.me/categories/cve/" title="2 posts">cve</a>
<a style="font-size: 1.2307692307692308em" href="https://www.serializing.me/categories/education/" title="4 posts">education</a>
<a style="font-size: 1em" href="https://www.serializing.me/categories/encryption/" title="1 posts">encryption</a>
<a style="font-size: 1.3076923076923077em" href="https://www.serializing.me/categories/exploit/" title="5 posts">exploit</a>
<a style="font-size: 1.2307692307692308em" href="https://www.serializing.me/categories/hardware-hacking/" title="4 posts">hardware-hacking</a>
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/incident-response/" title="3 posts">incident-response</a>
<a style="font-size: 1.8461538461538463em" href="https://www.serializing.me/categories/linux/" title="12 posts">linux</a>
<a style="font-size: 1.3076923076923077em" href="https://www.serializing.me/categories/malware/" title="5 posts">malware</a>
<a style="font-size: 1em" href="https://www.serializing.me/categories/memory-forensics/" title="1 posts">memory-forensics</a>
<a style="font-size: 1.4615384615384617em" href="https://www.serializing.me/categories/network/" title="7 posts">network</a>
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/reconnaissance/" title="3 posts">reconnaissance</a>
<a style="font-size: 1.8461538461538463em" href="https://www.serializing.me/categories/reverse-engineering/" title="12 posts">reverse-engineering</a>
<a style="font-size: 1.2307692307692308em" href="https://www.serializing.me/categories/virtualization/" title="4 posts">virtualization</a>
<a style="font-size: 2em" href="https://www.serializing.me/categories/windows/" title="14 posts">windows</a>


        </div>
      </div>
    </div>
    
    <div class="card my-4">
      <h5 class="card-header">Tags</h5>
      <div class="card-body">
        <div class="cloud">
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/active-directory/" title="3 posts">active-directory</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/activobank/" title="1 posts">activobank</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/acunetix-wvs/" title="1 posts">acunetix-wvs</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/android/" title="1 posts">android</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/applocker/" title="2 posts">applocker</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/aruba-networks/" title="2 posts">aruba-networks</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/attck/" title="1 posts">attck</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/banco-popular/" title="1 posts">banco-popular</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/banco-portugues-de-investimento/" title="1 posts">banco-portugues-de-investimento</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/banking/" title="1 posts">banking</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/barclays/" title="1 posts">barclays</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/bios/" title="1 posts">bios</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/brute-force/" title="1 posts">brute-force</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/bugcrowd/" title="3 posts">bugcrowd</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/caixa-geral-de-depositos/" title="1 posts">caixa-geral-de-depositos</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/caixadirecta/" title="1 posts">caixadirecta</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/cheat/" title="1 posts">cheat</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/cisco-anyconnect/" title="2 posts">cisco-anyconnect</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/code-injection/" title="1 posts">code-injection</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/csharp/" title="1 posts">csharp</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/cuckoo-sandbox/" title="2 posts">cuckoo-sandbox</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/e-gpu/" title="1 posts">e-gpu</a>
<a style="font-size: 1.75em" href="https://www.serializing.me/tags/emofishes/" title="4 posts">emofishes</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/emotions/" title="3 posts">emotions</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/fireeye/" title="3 posts">fireeye</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/gpo-bypass/" title="1 posts">gpo-bypass</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/group-policy-objects/" title="1 posts">group-policy-objects</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/honeypot/" title="1 posts">honeypot</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hook-functions/" title="1 posts">hook-functions</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hp/" title="1 posts">hp</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hpqpswdd/" title="1 posts">hpqpswdd</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hugo/" title="1 posts">hugo</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/ivre/" title="1 posts">ivre</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/lemp/" title="2 posts">lemp</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/metasploit/" title="1 posts">metasploit</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/millennium/" title="1 posts">millennium</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/novo-banco/" title="1 posts">novo-banco</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/paranoid-fish/" title="3 posts">paranoid-fish</a>
<a style="font-size: 1.75em" href="https://www.serializing.me/tags/passwords/" title="4 posts">passwords</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/portuguese/" title="1 posts">portuguese</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/powascripts/" title="3 posts">powascripts</a>
<a style="font-size: 1.75em" href="https://www.serializing.me/tags/powershell/" title="4 posts">powershell</a>
<a style="font-size: 2em" href="https://www.serializing.me/tags/qemu/" title="5 posts">qemu</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/raspberry-pi/" title="1 posts">raspberry-pi</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/razer/" title="1 posts">razer</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/red-team/" title="1 posts">red-team</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/soho/" title="3 posts">soho</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/ssh/" title="1 posts">ssh</a>
<a style="font-size: 2em" href="https://www.serializing.me/tags/suricata/" title="5 posts">suricata</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/technicolor/" title="3 posts">technicolor</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/titan-quest/" title="1 posts">titan-quest</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/tls/" title="3 posts">tls</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/tq-invincible/" title="1 posts">tq-invincible</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/usb/" title="1 posts">usb</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/virtualbox/" title="3 posts">virtualbox</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/volatility/" title="1 posts">volatility</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/vpn/" title="2 posts">vpn</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/wordpress/" title="3 posts">wordpress</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/yara/" title="1 posts">yara</a>


        </div>
      </div>
    </div>
  </div>
</div>



    </section>
    <footer class="mt-4 bg-dark">
<div class="container">
  <div class="row text-center">
  <div class="col-12 col-md my-4">
    <ul class="list-inline">

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://infosec.exchange/@serializingme" title="Mastodon">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-mastodon fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://www.twitch.tv/serializingme" title="Twitch">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-twitch fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://discord.gg/NS5qHT4" title="Discord">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-discord fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://www.youtube.com/serializingme" title="YouTube">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-youtube fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://github.com/serializingme" title="GitHub">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-github fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://bugcrowd.com/serializingme" title="Bugcrowd">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fas fa-bug fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://twitter.com/serializingme" title="Twitter">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-twitter fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

    </ul>
      <ul class="list-inline">

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-copyright"></i>&nbsp;</span><a class="footer-link text-light" href="/licensing/" title="Licensing">Licensing</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-eye"></i>&nbsp;</span><a class="footer-link text-light" href="/privacy/" title="Privacy">Privacy</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-shield-alt"></i>&nbsp;</span><a class="footer-link text-light" href="/security/" title="Security">Security</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-envelope"></i>&nbsp;</span><a class="footer-link text-light" href="/contacts/" title="Contacts">Contacts</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-rss"></i>&nbsp;</span><a class="footer-link text-light" href="/feeds/" title="Feeds">Feeds</a>
    </li>

  </ul>
  <small class="d-block mb-3 text-muted">&copy;&nbsp;2022&nbsp;Duarte Silva</small>
  </div>
</div>
</div>

    </footer>
<script src="https://www.serializing.me/js/jquery.min.js"></script>
<script src="https://www.serializing.me/js/bootstrap.min.js"></script>
<script src="https://www.serializing.me/js/fontawesome-solid.min.js"></script>
<script src="https://www.serializing.me/js/fontawesome-brands.min.js"></script>
<script src="https://www.serializing.me/js/fontawesome.min.js"></script><script src="https://www.serializing.me/js/serializingme.min.js"></script>
  </body>
</html>
