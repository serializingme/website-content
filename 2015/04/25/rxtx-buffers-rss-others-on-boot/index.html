<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#" class="bg-dark">
  <head>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#ffffff" />


<meta property="title" content="RX/TX Buffers, Flow Hash and Others on Boot - SerializingMe" />


  
<meta name="description" content="After installing Suricata, some fine tuning of the network interface(s) used in the traffic capture is required to ensure the best performance of the new IDPS installation..." />
  
  
    
    
<meta name="keywords" content="Suricata" />
    
  


<meta name="author" content="Duarte Silva" />



<meta itemprop="title" content="RX/TX Buffers, Flow Hash and Others on Boot - SerializingMe" />


  
<meta itemprop="description" content="After installing Suricata, some fine tuning of the network interface(s) used in the traffic capture is required to ensure the best performance of the new IDPS installation..." />
  
  
<meta itemprop="image" content="https://www.serializing.me/uploads/2015/04/ifup-local.png" />
  
  
    
    
<meta itemprop="keywords" content="Suricata" />
    
  
  
<meta itemprop="wordCount" content="840" />
  



<meta property="og:title" content="RX/TX Buffers, Flow Hash and Others on Boot - SerializingMe" />


  
<meta property="og:type" content="article" />
  
  
<meta property="og:description" content="After installing Suricata, some fine tuning of the network interface(s) used in the traffic capture is required to ensure the best performance of the new IDPS installation..." />
  
  
<meta property="og:image" content="https://www.serializing.me/uploads/2015/04/ifup-local.png" />
  


<meta property="og:url" content="https://www.serializing.me/2015/04/25/rxtx-buffers-rss-others-on-boot/" />


<meta property="og:site_name" content="SerializingMe" />



  
<meta name="twitter:card" content="summary_large_image" />
  



<meta name="twitter:title" content="RX/TX Buffers, Flow Hash and Others on Boot - SerializingMe" />


<meta name="twitter:url" content="https://www.serializing.me/2015/04/25/rxtx-buffers-rss-others-on-boot/" />


  
<meta name="twitter:description" content="After installing Suricata, some fine tuning of the network interface(s) used in the traffic capture is required to ensure the best performance of the new IDPS installation..." />
  
  
<meta name="twitter:image" content="https://www.serializing.me/uploads/2015/04/ifup-local.png" />
  


<title>RX/TX Buffers, Flow Hash and Others on Boot - SerializingMe</title>
<link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<link rel="manifest" href="https://www.serializing.me/manifest.json">
<link rel="mask-icon" href="https://www.serializing.me/safari-pinned-tab.svg" color="#5bbad5">

<link href="https://www.serializing.me/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Combined Feed" />
<link href="https://www.serializing.me/page/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Pages Feed" />
<link href="https://www.serializing.me/post/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Posts Feed" />
<link href="https://www.serializing.me/project/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Projects Feed" />

<link href="https://www.serializing.me/css/bootstrap-reboot.min.css" rel="stylesheet" />
<link href="https://www.serializing.me/css/bootstrap.min.css" rel="stylesheet" /><link href="https://www.serializing.me/css/serializingme.min.css" rel="stylesheet" />

  </head>
  <body>
    <header>
<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
  <div class="container">
    <a class="navbar-brand" href="https://www.serializing.me/">
      <img src="/brand.png" width="30" height="30" class="d-inline-block align-top" /> SerializingMe
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav ml-auto">


        <li class="nav-item "><a class="nav-link" title="Blog" href="https://www.serializing.me/post/">Blog</a></li>

        <li class="nav-item "><a class="nav-link" title="Projects" href="https://www.serializing.me/project/">Projects</a></li>

        <li class="nav-item "><a class="nav-link" title="Contributions" href="https://www.serializing.me/contributions/">Contributions</a></li>

        <li class="nav-item "><a class="nav-link" title="About" href="https://www.serializing.me/about/">About</a></li>

      </ul>
    </div>
  </div>
</nav>
<noscript>
  <div class="container mt-2 mb-0">
    <div class="alert alert-danger">JavaScript is disabled, this site will not work properly without it.</div>
  </div>
</noscript>

    </header>
    <section class="container">


  <div class="row">
  
  <div class="col-lg-8">
    
    <div class="card mb-4 my-4"><img class="card-img-top" src="/uploads/2015/04/ifup-local.png" alt="RX/TX Buffers, Flow Hash and Others on Boot" /><div class="card-body">
        <h2 class="card-title">
RX/TX Buffers, Flow Hash and Others on Boot
        </h2>
        <div>
<p>After installing Suricata, some fine tuning of the network interface(s) used in the traffic capture is required to ensure every ounce of performance is extracted from the new IDPS installation. Those configurations need to be persisted when the system is power cycled. To do that on a Enterprise Linux based OS (e.g. RedHat, CentOS, Fedora, etc.) one can leverage the <code>/sbin/ifup-local</code> script.</p>
<p>This script is called per interface by the network configuration utility when the network is up and running (at least when using a static configuration). The performance oriented configurations that are usually needed are:</p>
<ul>
<li>Set the network card RX/TX buffers to the maximum that the hardware supports</li>
<li>Balance the receive flow hash indirection table equally in all CPU&rsquo;s</li>
<li>Set the receive network card and transmits IRQ affinity to one CPU each</li>
<li>Turn off offloading features (only if using PF_RING, AF_PACKET or similar)</li>
</ul>
<p>The kernel network stack can also be tuned using the <code>/sbin/ifup-local</code> script, however the recommended approach is to use a file under the <code>/etc/sysctl.d/</code> directory instead. The <code>ifup-local</code> file doesn&rsquo;t usually exist, so it needs to be created and made executable.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2</span><span style="color:#cd2828;font-weight:bold"></span><span style="color:#999;font-style:italic"># Create the file</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">3</span>touch /sbin/ifup-local
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">5</span><span style="color:#999;font-style:italic"># Make it executable</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">6</span>chmod +x /sbin/ifup-local
</code></pre></div><p>Follows the contents of the script that I use.</p>
<div class="alert alert-warning"><span><i class="fas fa-exclamation-triangle"></i>&nbsp;</span>The name of the interrupts for the network card may vary, and it may support more or less offloading features, adjust accordingly.</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span><span style="color:#cd2828;font-weight:bold"></span>set_buffers() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span>    <span style="color:#999;font-style:italic"># Get the hardware RX/TX maximum and current</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span>    <span style="color:#40ffff">PRESET</span>=<span style="color:#6ab825;font-weight:bold">$(</span>ethtool -g <span style="color:#40ffff">$1</span> | tr <span style="color:#ed9d13">&#39;\n&#39;</span> <span style="color:#ed9d13">&#39; &#39;</span> | sed <span style="color:#ed9d13">&#39;s/.*RX:\s\+\([0-9]\+\).*TX:\s\+\([0-9]\+\).*RX:\s\+\([0-9]\+\).*TX:\s\+\([0-9]\+\).*/\1 \2 \3 \4/g&#39;</span><span style="color:#6ab825;font-weight:bold">)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span>    <span style="color:#999;font-style:italic"># Set receive and trasmit buffers to the hardware maximum</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span>    ethtool -G <span style="color:#40ffff">$1</span> rx <span style="color:#6ab825;font-weight:bold">$(</span><span style="color:#24909d">echo</span> <span style="color:#40ffff">$PRESET</span> | cut -f <span style="color:#3677a9">1</span> -d <span style="color:#ed9d13">&#34; &#34;</span><span style="color:#6ab825;font-weight:bold">)</span> tx <span style="color:#6ab825;font-weight:bold">$(</span><span style="color:#24909d">echo</span> <span style="color:#40ffff">$PRESET</span> | cut -f <span style="color:#3677a9">2</span> -d <span style="color:#ed9d13">&#34; &#34;</span><span style="color:#6ab825;font-weight:bold">)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span>balance_flowhash() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span>    <span style="color:#999;font-style:italic"># Balance evenly per CPU</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span>    ethtool -X <span style="color:#40ffff">$1</span> equal <span style="color:#6ab825;font-weight:bold">$(</span>cat /proc/cpuinfo | grep processor | wc -l<span style="color:#6ab825;font-weight:bold">)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">15</span>set_affinity() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">16</span>    <span style="color:#40ffff">MAX</span>=<span style="color:#6ab825;font-weight:bold">$(</span>cat /proc/cpuinfo | grep processor | wc -l<span style="color:#6ab825;font-weight:bold">)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">17</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">18</span>    <span style="color:#999;font-style:italic"># Since the receive/transmit interrupts name index starts at 0, subtract 1 from the maximum</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">19</span>    <span style="color:#24909d">let</span> <span style="color:#ed9d13">&#34;MAX=</span><span style="color:#40ffff">$MAX</span><span style="color:#ed9d13">-1&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">20</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">21</span>    <span style="color:#999;font-style:italic"># The mask that will define the affinity</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">22</span>    <span style="color:#40ffff">MASK</span>=<span style="color:#3677a9">1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">23</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">24</span>    <span style="color:#6ab825;font-weight:bold">for</span> INDEX in <span style="color:#6ab825;font-weight:bold">$(</span>seq <span style="color:#3677a9">0</span> <span style="color:#3677a9">1</span> <span style="color:#40ffff">$MAX</span><span style="color:#6ab825;font-weight:bold">)</span>; <span style="color:#6ab825;font-weight:bold">do</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">25</span>        <span style="color:#40ffff">IRQ</span>=<span style="color:#6ab825;font-weight:bold">$(</span>cat /proc/interrupts | grep <span style="color:#40ffff">$1</span>-rxtx-<span style="color:#40ffff">$INDEX</span><span style="color:#ed9d13">&#34;</span>$<span style="color:#ed9d13">&#34;</span> | sed <span style="color:#ed9d13">&#39;s/\s\([0-9]\+\)\(.*\)/\1/g&#39;</span><span style="color:#6ab825;font-weight:bold">)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">26</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">27</span>        <span style="color:#999;font-style:italic"># Apply the mask to the current IRQ</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">28</span>        <span style="color:#24909d">printf</span> <span style="color:#ed9d13">&#34;%X&#34;</span> <span style="color:#40ffff">$MASK</span> &gt; /proc/irq/<span style="color:#40ffff">$IRQ</span>/smp_affinity
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">29</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">30</span>        <span style="color:#999;font-style:italic"># Duplicate the next mask value</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">31</span>        <span style="color:#24909d">let</span> <span style="color:#ed9d13">&#34;MASK=</span><span style="color:#40ffff">$MASK</span><span style="color:#ed9d13">+</span><span style="color:#40ffff">$MASK</span><span style="color:#ed9d13">&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">32</span>    <span style="color:#6ab825;font-weight:bold">done</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">33</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">34</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">35</span>turnoff_offloading() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">36</span>    ethtool -K <span style="color:#40ffff">$1</span> rx off
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">37</span>    ethtool -K <span style="color:#40ffff">$1</span> tx off
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">38</span>    ethtool -K <span style="color:#40ffff">$1</span> sg off
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">39</span>    ethtool -K <span style="color:#40ffff">$1</span> tso off
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">40</span>    ethtool -K <span style="color:#40ffff">$1</span> gso off
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">41</span>    ethtool -K <span style="color:#40ffff">$1</span> gro off
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">42</span>    ethtool -K <span style="color:#40ffff">$1</span> lro off
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">43</span>    ethtool -K <span style="color:#40ffff">$1</span> rxvlan off
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">44</span>    ethtool -K <span style="color:#40ffff">$1</span> txvlan off
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">45</span>    ethtool -K <span style="color:#40ffff">$1</span> rxhash off
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">46</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">47</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">48</span><span style="color:#6ab825;font-weight:bold">case</span> <span style="color:#ed9d13">&#34;</span><span style="color:#40ffff">$1</span><span style="color:#ed9d13">&#34;</span> in
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">49</span>eth1)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">50</span>    <span style="color:#999;font-style:italic"># Update the receive and transmit buffers</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">51</span>    set_buffers <span style="color:#40ffff">$1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">52</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">53</span>    <span style="color:#999;font-style:italic"># Balance receive flow hash indirection table</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">54</span>    balance_flowhash <span style="color:#40ffff">$1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">55</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">56</span>    <span style="color:#999;font-style:italic"># Set CPU affinity for the interrupts</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">57</span>    set_affinity <span style="color:#40ffff">$1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">58</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">59</span>    <span style="color:#999;font-style:italic"># Offloading features</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">60</span>    turnoff_offloading <span style="color:#40ffff">$1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">61</span>;;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">62</span><span style="color:#6ab825;font-weight:bold">esac</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">63</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">64</span><span style="color:#24909d">exit</span> <span style="color:#3677a9">0</span>
</code></pre></div><p>After a reboot, to verify if the configurations have been applied correctly (the system used in this example as 8 CPU&rsquo;s) issue the following commands.</p>
<div class="alert alert-warning"><span><i class="fas fa-exclamation-triangle"></i>&nbsp;</span>The network interface used in the commands bellow is <strong>eth1</strong>, change accordingly.</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span><span style="color:#cd2828;font-weight:bold"></span><span style="color:#999;font-style:italic"># Verify the send and receive buffers, note how the current hardware values are the same as the pre-set maximum values</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span>ethtool -g eth1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span><span style="color:#999;font-style:italic"># Ring parameters for eth1:</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span><span style="color:#999;font-style:italic"># Pre-set maximums:</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span><span style="color:#999;font-style:italic"># RX:             4096</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span><span style="color:#999;font-style:italic"># RX Mini:        0</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span><span style="color:#999;font-style:italic"># RX Jumbo:       0</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span><span style="color:#999;font-style:italic"># TX:             4096</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span><span style="color:#999;font-style:italic"># Current hardware settings:</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span><span style="color:#999;font-style:italic"># RX:             4096</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span><span style="color:#999;font-style:italic"># RX Mini:        0</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span><span style="color:#999;font-style:italic"># RX Jumbo:       0</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14</span><span style="color:#999;font-style:italic"># TX:             4096</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">15</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">16</span><span style="color:#999;font-style:italic"># Verify the flow hash indirection table</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">17</span>ethtool -x eth1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">18</span><span style="color:#999;font-style:italic"># RX flow hash indirection table for eth1 with 8 RX ring(s):</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">19</span><span style="color:#999;font-style:italic">#     0:      0     1     2     3     4     5     6     7</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">20</span><span style="color:#999;font-style:italic">#     8:      0     1     2     3     4     5     6     7</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">21</span><span style="color:#999;font-style:italic">#    16:      0     1     2     3     4     5     6     7</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">22</span><span style="color:#999;font-style:italic">#    24:      0     1     2     3     4     5     6     7</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">23</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">24</span><span style="color:#999;font-style:italic"># Verify that the IRQ affinity is set correctly, the output bellow shows only the first 4 CPU&#39;s</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">25</span>cat /proc/interrupts | grep <span style="color:#ed9d13">&#39;CPU\|eth1&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">26</span><span style="color:#999;font-style:italic">#            CPU0       CPU1       CPU2       CPU3   (...)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">27</span><span style="color:#999;font-style:italic">#  65:  107325835          0          3          0         eth1-rxtx-0</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">28</span><span style="color:#999;font-style:italic">#  66:          0  150380495          0          2         eth1-rxtx-1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">29</span><span style="color:#999;font-style:italic">#  67:          0          0  107109972          0         eth1-rxtx-2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">30</span><span style="color:#999;font-style:italic">#  68:          0          0          0   91046195         eth1-rxtx-3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">31</span><span style="color:#999;font-style:italic"># (...)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">32</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">33</span><span style="color:#999;font-style:italic"># Verify that the offloading features are off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">34</span>ethtool -k eth1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">35</span><span style="color:#999;font-style:italic"># Features for eth1:</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">36</span><span style="color:#999;font-style:italic"># rx-checksumming: off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">37</span><span style="color:#999;font-style:italic"># tx-checksumming: off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">38</span><span style="color:#999;font-style:italic">#         tx-checksum-ipv4: off [fixed]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">39</span><span style="color:#999;font-style:italic">#         tx-checksum-ip-generic: off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">40</span><span style="color:#999;font-style:italic">#         tx-checksum-ipv6: off [fixed]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">41</span><span style="color:#999;font-style:italic">#         tx-checksum-fcoe-crc: off [fixed]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">42</span><span style="color:#999;font-style:italic">#         tx-checksum-sctp: off [fixed]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">43</span><span style="color:#999;font-style:italic"># scatter-gather: off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">44</span><span style="color:#999;font-style:italic">#         tx-scatter-gather: off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">45</span><span style="color:#999;font-style:italic">#         tx-scatter-gather-fraglist: off [fixed]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">46</span><span style="color:#999;font-style:italic"># tcp-segmentation-offload: off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">47</span><span style="color:#999;font-style:italic">#         tx-tcp-segmentation: off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">48</span><span style="color:#999;font-style:italic">#         tx-tcp-ecn-segmentation: off [fixed]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">49</span><span style="color:#999;font-style:italic">#         tx-tcp6-segmentation: off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">50</span><span style="color:#999;font-style:italic"># udp-fragmentation-offload: off [fixed]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">51</span><span style="color:#999;font-style:italic"># generic-segmentation-offload: off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">52</span><span style="color:#999;font-style:italic"># generic-receive-offload: off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">53</span><span style="color:#999;font-style:italic"># large-receive-offload: off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">54</span><span style="color:#999;font-style:italic"># rx-vlan-offload: off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">55</span><span style="color:#999;font-style:italic"># tx-vlan-offload: off</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">56</span><span style="color:#999;font-style:italic"># (...)</span>
</code></pre></div><p>Happy tuning!</p></div>
      </div>
      <div class="card-footer">
<span><i class="fas fa-calendar-alt"></i>&nbsp;</span>April 25, 2015&nbsp;&nbsp;<br/>
<span><i class="fas fa-folder-open"></i>&nbsp;</span><a href="https://www.serializing.me/categories/configuration/">Configuration</a>,&nbsp;<a href="https://www.serializing.me/categories/linux/">Linux</a>,&nbsp;<a href="https://www.serializing.me/categories/network/">Network</a>&nbsp;&nbsp;<br/>
<span><i class="fas fa-tag"></i>&nbsp;</span><a href="https://www.serializing.me/tags/suricata/">Suricata</a>
      </div>
    </div>
    <ul class="pagination justify-content-center mb-4"><li class="page-item">
        <a href="https://www.serializing.me/2015/05/03/check-my-cv-generating-yara-rules/" title="&#34;Check my CV&#34;, Generating YARA Rules" class="page-link"><span><i class="fas fa-chevron-left"></i>&nbsp;</span>Newer</a>
      </li><li class="page-item">
    <a href="https://www.serializing.me/2015/04/25/hello-world/" title="Hello World!" class="page-link">Older<span>&nbsp;<i class="fas fa-chevron-right"></i>&nbsp;</span></a>
  </li></ul>
  </div>
  
  <div class="col-md-4">
    
    <div class="card my-4">
      <h5 class="card-header">Categories</h5>
      <div class="card-body">
        <div class="cloud">
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/bug-bounty/" title="3 posts">bug-bounty</a>
<a style="font-size: 1.2307692307692308em" href="https://www.serializing.me/categories/case-study/" title="4 posts">case-study</a>
<a style="font-size: 1.5384615384615385em" href="https://www.serializing.me/categories/configuration/" title="8 posts">configuration</a>
<a style="font-size: 1.0769230769230769em" href="https://www.serializing.me/categories/cve/" title="2 posts">cve</a>
<a style="font-size: 1em" href="https://www.serializing.me/categories/encryption/" title="1 posts">encryption</a>
<a style="font-size: 1.3076923076923077em" href="https://www.serializing.me/categories/exploit/" title="5 posts">exploit</a>
<a style="font-size: 1.2307692307692308em" href="https://www.serializing.me/categories/hardware-hacking/" title="4 posts">hardware-hacking</a>
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/incident-response/" title="3 posts">incident-response</a>
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/learning/" title="3 posts">learning</a>
<a style="font-size: 1.8461538461538463em" href="https://www.serializing.me/categories/linux/" title="12 posts">linux</a>
<a style="font-size: 1.3076923076923077em" href="https://www.serializing.me/categories/malware/" title="5 posts">malware</a>
<a style="font-size: 1em" href="https://www.serializing.me/categories/memory-forensics/" title="1 posts">memory-forensics</a>
<a style="font-size: 1.5384615384615385em" href="https://www.serializing.me/categories/network/" title="8 posts">network</a>
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/reconnaissance/" title="3 posts">reconnaissance</a>
<a style="font-size: 1.9230769230769231em" href="https://www.serializing.me/categories/reverse-engineering/" title="13 posts">reverse-engineering</a>
<a style="font-size: 1.2307692307692308em" href="https://www.serializing.me/categories/virtualization/" title="4 posts">virtualization</a>
<a style="font-size: 2em" href="https://www.serializing.me/categories/windows/" title="14 posts">windows</a>


        </div>
      </div>
    </div>
    
    <div class="card my-4">
      <h5 class="card-header">Tags</h5>
      <div class="card-body">
        <div class="cloud">
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/active-directory/" title="3 posts">active-directory</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/acunetix-wvs/" title="1 posts">acunetix-wvs</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/android/" title="1 posts">android</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/applocker/" title="2 posts">applocker</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/aruba-networks/" title="2 posts">aruba-networks</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/attck/" title="1 posts">attck</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/banking/" title="1 posts">banking</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/bios/" title="1 posts">bios</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/brute-force/" title="1 posts">brute-force</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/bugcrowd/" title="3 posts">bugcrowd</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/cac-ipc/" title="3 posts">cac-ipc</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/cheat/" title="1 posts">cheat</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/cisco-anyconnect/" title="3 posts">cisco-anyconnect</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/code-injection/" title="1 posts">code-injection</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/csharp/" title="1 posts">csharp</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/cuckoo-sandbox/" title="2 posts">cuckoo-sandbox</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/e-gpu/" title="1 posts">e-gpu</a>
<a style="font-size: 1.75em" href="https://www.serializing.me/tags/emofishes/" title="4 posts">emofishes</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/emotions/" title="3 posts">emotions</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/fireeye/" title="3 posts">fireeye</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/gpo-bypass/" title="1 posts">gpo-bypass</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/group-policy-objects/" title="1 posts">group-policy-objects</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/honeypot/" title="1 posts">honeypot</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hook-functions/" title="1 posts">hook-functions</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hp/" title="1 posts">hp</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hpqpswdd/" title="1 posts">hpqpswdd</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hugo/" title="1 posts">hugo</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/ivre/" title="1 posts">ivre</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/lemp/" title="2 posts">lemp</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/metasploit/" title="1 posts">metasploit</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/paranoid-fish/" title="3 posts">paranoid-fish</a>
<a style="font-size: 1.75em" href="https://www.serializing.me/tags/passwords/" title="4 posts">passwords</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/portuguese/" title="2 posts">portuguese</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/powascripts/" title="3 posts">powascripts</a>
<a style="font-size: 1.75em" href="https://www.serializing.me/tags/powershell/" title="4 posts">powershell</a>
<a style="font-size: 2em" href="https://www.serializing.me/tags/qemu/" title="5 posts">qemu</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/raspberry-pi/" title="1 posts">raspberry-pi</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/razer/" title="1 posts">razer</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/red-team/" title="1 posts">red-team</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/soho/" title="3 posts">soho</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/ssh/" title="1 posts">ssh</a>
<a style="font-size: 2em" href="https://www.serializing.me/tags/suricata/" title="5 posts">suricata</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/technicolor/" title="3 posts">technicolor</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/titan-quest/" title="1 posts">titan-quest</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/tls/" title="1 posts">tls</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/tq-invincible/" title="1 posts">tq-invincible</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/usb/" title="1 posts">usb</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/virtualbox/" title="3 posts">virtualbox</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/volatility/" title="1 posts">volatility</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/wordpress/" title="3 posts">wordpress</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/yara/" title="1 posts">yara</a>


        </div>
      </div>
    </div>
  </div>
</div>



    </section>
    <footer class="mt-4 bg-dark">
<div class="container">
  <div class="row text-center">
  <div class="col-12 col-md my-4">
    <ul class="list-inline">

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://infosec.exchange/@serializingme" title="Mastodon">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-mastodon fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://www.twitch.tv/serializingme" title="Twitch">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-twitch fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://discord.gg/NS5qHT4" title="Discord">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-discord fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://www.youtube.com/serializingme" title="YouTube">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-youtube fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://github.com/serializingme" title="GitHub">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-github fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://bugcrowd.com/serializingme" title="Bugcrowd">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fas fa-bug fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://twitter.com/serializingme" title="Twitter">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-twitter fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

    </ul>
      <ul class="list-inline">

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-copyright"></i>&nbsp;</span><a class="footer-link text-light" href="/licensing/" title="Licensing">Licensing</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-eye"></i>&nbsp;</span><a class="footer-link text-light" href="/privacy/" title="Privacy">Privacy</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-shield-alt"></i>&nbsp;</span><a class="footer-link text-light" href="/security/" title="Security">Security</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-envelope"></i>&nbsp;</span><a class="footer-link text-light" href="/contacts/" title="Contacts">Contacts</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-rss"></i>&nbsp;</span><a class="footer-link text-light" href="/feeds/" title="Feeds">Feeds</a>
    </li>

  </ul>
  <small class="d-block mb-3 text-muted">&copy;&nbsp;2023&nbsp;Duarte Silva</small>
  </div>
</div>
</div>

    </footer>
<script src="https://www.serializing.me/js/jquery.min.js"></script>
<script src="https://www.serializing.me/js/bootstrap.min.js"></script>
<script src="https://www.serializing.me/js/fontawesome-solid.min.js"></script>
<script src="https://www.serializing.me/js/fontawesome-brands.min.js"></script>
<script src="https://www.serializing.me/js/fontawesome.min.js"></script><script src="https://www.serializing.me/js/serializingme.min.js"></script>
  </body>
</html>
