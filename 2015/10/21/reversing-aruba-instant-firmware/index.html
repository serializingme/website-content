<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#" class="bg-dark">
  <head>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#ffffff" />


<meta property="title" content="Reversing Aruba Instant Firmware - SerializingMe" />


  
<meta name="description" content="How to extract all the files recreating an Aruba Instant appliance running file system..." />
  
  
    
    
<meta name="keywords" content="Aruba Networks,Bugcrowd" />
    
  


<meta name="author" content="Duarte Silva" />



<meta itemprop="title" content="Reversing Aruba Instant Firmware - SerializingMe" />


  
<meta itemprop="description" content="How to extract all the files recreating an Aruba Instant appliance running file system..." />
  
  
<meta itemprop="image" content="https://www.serializing.me/uploads/2015/10/arubaos-instant.png" />
  
  
    
    
<meta itemprop="keywords" content="Aruba Networks,Bugcrowd" />
    
  
  
<meta itemprop="wordCount" content="814" />
  



<meta property="og:title" content="Reversing Aruba Instant Firmware - SerializingMe" />


  
<meta property="og:type" content="article" />
  
  
<meta property="og:description" content="How to extract all the files recreating an Aruba Instant appliance running file system..." />
  
  
<meta property="og:image" content="https://www.serializing.me/uploads/2015/10/arubaos-instant.png" />
  


<meta property="og:url" content="https://www.serializing.me/2015/10/21/reversing-aruba-instant-firmware/" />


<meta property="og:site_name" content="SerializingMe" />



  
<meta name="twitter:card" content="summary_large_image" />
  



<meta name="twitter:title" content="Reversing Aruba Instant Firmware - SerializingMe" />


<meta name="twitter:url" content="https://www.serializing.me/2015/10/21/reversing-aruba-instant-firmware/" />


  
<meta name="twitter:description" content="How to extract all the files recreating an Aruba Instant appliance running file system..." />
  
  
<meta name="twitter:image" content="https://www.serializing.me/uploads/2015/10/arubaos-instant.png" />
  


<title>Reversing Aruba Instant Firmware - SerializingMe</title>
<link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<link rel="manifest" href="https://www.serializing.me/manifest.json">
<link rel="mask-icon" href="https://www.serializing.me/safari-pinned-tab.svg" color="#5bbad5">

<link href="https://www.serializing.me/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Combined Feed" />
<link href="https://www.serializing.me/page/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Pages Feed" />
<link href="https://www.serializing.me/post/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Posts Feed" />
<link href="https://www.serializing.me/project/index.xml" rel="alternate" type="application/rss+xml" title="SerializingMe Projects Feed" />

<link href="https://www.serializing.me/css/bootstrap-reboot.min.css" rel="stylesheet" />
<link href="https://www.serializing.me/css/bootstrap.min.css" rel="stylesheet" /><link href="https://www.serializing.me/css/serializingme.min.css" rel="stylesheet" />

  </head>
  <body>
    <header>
<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
  <div class="container">
    <a class="navbar-brand" href="https://www.serializing.me/">
      <img src="/brand.png" width="30" height="30" class="d-inline-block align-top" /> SerializingMe
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav ml-auto">


        <li class="nav-item "><a class="nav-link" title="Blog" href="https://www.serializing.me/post/">Blog</a></li>

        <li class="nav-item "><a class="nav-link" title="Projects" href="https://www.serializing.me/project/">Projects</a></li>

        <li class="nav-item "><a class="nav-link" title="Contributions" href="https://www.serializing.me/contributions/">Contributions</a></li>

        <li class="nav-item "><a class="nav-link" title="About" href="https://www.serializing.me/about/">About</a></li>

      </ul>
    </div>
  </div>
</nav>
<noscript>
  <div class="container mt-2 mb-0">
    <div class="alert alert-danger">JavaScript is disabled, this site will not work properly without it.</div>
  </div>
</noscript>

    </header>
    <section class="container">


  <div class="row">
  
  <div class="col-lg-8">
    
    <div class="card mb-4 my-4"><img class="card-img-top" src="/uploads/2015/10/arubaos-instant.png" alt="Reversing Aruba Instant Firmware" /><div class="card-body">
        <h2 class="card-title">
Reversing Aruba Instant Firmware
        </h2>
        <div class="text-justify">
<p>Aruba produces two different software loads for their Access Point hardware. The first is called ArubaOS and the second is called Aruba Instant. With ArubaOS, the AP requires a Mobility Controller (hardware) to be installed in the network. With the Aruba Instant it is possible to run AP&rsquo;s independently (standalone mode) or in a cluster, with no Mobility Controller in the network.</p>
<p>What follows is the full process to extract all the files recreating the Aruba Instant firmware file system.</p>
<div class="alert alert-info"><span><i class="fas fa-info-circle"></i>&nbsp;</span>This article was authorized by Aruba Networks and is based in the work done in the scope of Aruba&rsquo;s Bugcrowd bug bounty. Once <a href="https://www.serializing.me/2015/06/02/reversing-arubaos-firmware/">again</a>, thanks to Aruba Networks for their open approach to security researchers work.</div>
<p>As usual, the initial step is to check what the firmware image contains, <code>binwalk</code> was used for that.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2</span><span style="color:#cd2828;font-weight:bold"></span>binwalk image.bin
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">3</span><span style="color:#999;font-style:italic">#</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">4</span><span style="color:#999;font-style:italic">#DECIMAL       HEXADECIMAL     DESCRIPTION</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">5</span><span style="color:#999;font-style:italic">#--------------------------------------------------------------------------------</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">6</span><span style="color:#999;font-style:italic">#514           0x202           uImage header, header size: 64 bytes, header CRC: 0x26175460, created: Wed May 27 14:22:39 2015, image size: 10090700 bytes, Data Address: 0x80008000, Entry Point: 0x80008000, data CRC: 0x63E746B1, OS: Linux, CPU: ARM, image type: OS Kernel Image, compression type: none, image name: &#34;Linux-2.6.35&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">7</span><span style="color:#999;font-style:italic">#7706          0x1E1A          LZMA compressed data, properties: 0x5D, dictionary size: 33554432 bytes, uncompressed size: -1 bytes</span>
</code></pre></div><p>This firmware image looks like a standard U-Boot image. The next step is to extract the header and then the body of the image.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2</span><span style="color:#cd2828;font-weight:bold"></span><span style="color:#999;font-style:italic"># Extract the header</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">3</span>dd <span style="color:#6ab825;font-weight:bold">if</span>=image.bin <span style="color:#40ffff">bs</span>=<span style="color:#3677a9">514</span> <span style="color:#40ffff">count</span>=<span style="color:#3677a9">1</span> <span style="color:#40ffff">of</span>=image.header
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">4</span><span style="color:#999;font-style:italic">#1+0 records in</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">5</span><span style="color:#999;font-style:italic">#1+0 records out</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">6</span><span style="color:#999;font-style:italic">#514 bytes (514 B) copied, 0.000580873 s, 885 kB/s</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">7</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">8</span><span style="color:#999;font-style:italic"># Extract the body</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">9</span>tail -c+515 &lt; image.bin &gt; image.uimage
</code></pre></div><p>Checking the previously extracted image body reveals a matryoshka doll. Same process is followed as for the initial image file, extract the image header and afterwards, the body.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span><span style="color:#cd2828;font-weight:bold"></span><span style="color:#999;font-style:italic"># Verify the extracted file contents</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span>binwalk image.uimage
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span><span style="color:#999;font-style:italic">#DECIMAL       HEXADECIMAL     DESCRIPTION</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span><span style="color:#999;font-style:italic">#--------------------------------------------------------------------------------</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span><span style="color:#999;font-style:italic">#0             0x0             uImage header, header size: 64 bytes, header CRC: 0x26175460, created: Wed May 27 14:22:39 2015, image size: 10090700 bytes, Data Address: 0x80008000, Entry Point: 0x80008000, data CRC: 0x63E746B1, OS: Linux, CPU: ARM, image type: OS Kernel Image, compression type: none, image name: &#34;Linux-2.6.35&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span><span style="color:#999;font-style:italic">#7192          0x1C18          LZMA compressed data, properties: 0x5D, dictionary size: 33554432 bytes, uncompressed size: -1 bytes</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span><span style="color:#999;font-style:italic"># Extract the header of the new U-Boot image</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span>dd <span style="color:#6ab825;font-weight:bold">if</span>=image.uimage <span style="color:#40ffff">bs</span>=<span style="color:#3677a9">64</span> <span style="color:#40ffff">count</span>=<span style="color:#3677a9">1</span> <span style="color:#40ffff">of</span>=image.uimage.header
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span><span style="color:#999;font-style:italic">#1+0 records in</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span><span style="color:#999;font-style:italic">#1+0 records out</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span><span style="color:#999;font-style:italic">#64 bytes (64 B) copied, 0.00699276 s, 9.2 kB/s</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">15</span><span style="color:#999;font-style:italic"># Extract the body of the new U-Boot image</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">16</span>tail -c+65 &lt; image.uimage &gt; image.uimage.data
</code></pre></div><p>Checking the new U-Boot image body with <code>file</code> and <code>binwalk</code>, reveals that the extracted file is the bootable image. This image contains another interesting and compressed file.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span><span style="color:#cd2828;font-weight:bold"></span>file image.uimage.data
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span><span style="color:#999;font-style:italic">#image.uimage.data: Linux kernel ARM boot executable zImage (little-endian)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span><span style="color:#999;font-style:italic"># Yet another compressed file is revealed</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span>binwalk image.uimage.data
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span><span style="color:#999;font-style:italic">#</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span><span style="color:#999;font-style:italic">#DECIMAL       HEXADECIMAL     DESCRIPTION</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span><span style="color:#999;font-style:italic">#--------------------------------------------------------------------------------</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span><span style="color:#999;font-style:italic">#7128          0x1BD8          LZMA compressed data, properties: 0x5D, dictionary size: 33554432 bytes, uncompressed size: -1 bytes</span>
</code></pre></div><p>When this file is extracted and decompressed, the final matryoshka doll is revealed (the one containing the file system).</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span><span style="color:#999;font-style:italic"># Extract the header</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span>dd <span style="color:#6ab825;font-weight:bold">if</span>=image.uimage.data <span style="color:#40ffff">bs</span>=<span style="color:#3677a9">1</span> <span style="color:#40ffff">count</span>=<span style="color:#3677a9">7128</span> <span style="color:#40ffff">of</span>=image.uimage.data.header
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span><span style="color:#999;font-style:italic"># Extract the compressed file</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span>tail -c+7129 &lt; image.uimage.data &gt; image.uimage.data.compressed.lzma
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span><span style="color:#999;font-style:italic"># Decompress it</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span>7z x image.uimage.data.compressed.lzma
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span><span style="color:#999;font-style:italic">#</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span><span style="color:#999;font-style:italic">#7-Zip 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span><span style="color:#999;font-style:italic">#p7zip Version 9.20 (locale=en_GB.UTF-8,Utf16=on,HugeFiles=on,2 CPUs)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span><span style="color:#999;font-style:italic">#</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span><span style="color:#999;font-style:italic">#Processing archive: image.uimage.data.compressed.lzma</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14</span><span style="color:#999;font-style:italic">#</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">15</span><span style="color:#999;font-style:italic">#Extracting  image.uimage.data.compressed</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">16</span><span style="color:#999;font-style:italic">#</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">17</span><span style="color:#999;font-style:italic">#Everything is Ok</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">18</span><span style="color:#999;font-style:italic">#</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">19</span><span style="color:#999;font-style:italic">#Size:       12220288</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">20</span><span style="color:#999;font-style:italic">#Compressed: 10085616</span>
</code></pre></div><p>The final matryoshka doll is a <em>LZMA</em> compressed <em>cpio</em> file.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span><span style="color:#cd2828;font-weight:bold"></span>binwalk image.uimage.data.compressed
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span><span style="color:#999;font-style:italic">#</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span><span style="color:#999;font-style:italic">#DECIMAL       HEXADECIMAL     DESCRIPTION</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span><span style="color:#999;font-style:italic">#--------------------------------------------------------------------------------</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span><span style="color:#999;font-style:italic">#94208         0x17000         LZMA compressed data, properties: 0x5D, dictionary size: 33554432 bytes, uncompressed size: 34330624 bytes</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span><span style="color:#999;font-style:italic">#11455148      0xAECAAC        Copyright string: &#34; (c) 2002-2015, Aruba Networks, Inc. Inc.&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span><span style="color:#999;font-style:italic">#11455868      0xAECD7C        ASCII cpio archive (SVR4 with no CRC), file name: &#34;cate dir_entry buffer&#34;, file name length: &#34;0xR!!!&#34;, file size: &#34;0x&gt;Initram&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span><span style="color:#999;font-style:italic">#11462204      0xAEE63C        Unix home path string: &#34;/home/p4build/depot/margot/IAP4.1.1.7_50209/aos-cmn/platform/os&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span><span style="color:#999;font-style:italic">#12206595      0xBA4203        LZMA compressed data, properties: 0xC0, dictionary size: 524288 bytes, uncompressed size: 720896 bytes</span>
</code></pre></div><p>Extract the file and decompress it with <em>7-Zip</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span><span style="color:#cd2828;font-weight:bold"></span><span style="color:#999;font-style:italic"># Extract the file</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span>tail -c+94209 &lt; image.uimage.data.compressed &gt; image.uimage.data.compressed.cpio.lzma
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span><span style="color:#999;font-style:italic"># Decompress it</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span>7z x image.uimage.data.compressed.cpio.lzma
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span><span style="color:#999;font-style:italic">#</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span><span style="color:#999;font-style:italic">#7-Zip 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span><span style="color:#999;font-style:italic">#p7zip Version 9.20 (locale=en_GB.UTF-8,Utf16=on,HugeFiles=on,2 CPUs)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span><span style="color:#999;font-style:italic">#</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span><span style="color:#999;font-style:italic">#Processing archive: image.uimage.data.compressed.cpio.lzma</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span><span style="color:#999;font-style:italic">#</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span><span style="color:#999;font-style:italic">#Extracting  image.uimage.data.compressed.cpio</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14</span><span style="color:#999;font-style:italic">#</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">15</span><span style="color:#999;font-style:italic">#Everything is Ok</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">16</span><span style="color:#999;font-style:italic">#</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">17</span><span style="color:#999;font-style:italic">#Size:       34330624</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">18</span><span style="color:#999;font-style:italic">#Compressed: 12126080</span>
</code></pre></div><p>The last step, is to assemble everything in order to mimic the appliance running file system layout.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span><span style="color:#cd2828;font-weight:bold"></span><span style="color:#999;font-style:italic"># Create a new directory to hold the root file system</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span>mkdir rootfs
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span><span style="color:#999;font-style:italic"># Extract the files</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span><span style="color:#24909d">cd</span> rootfs/
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span>cpio --quiet -i --make-directories --preserve-modification-time --no-absolute-filenames -F ../image.uimage.data.compressed.cpio
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span><span style="color:#999;font-style:italic">#cpio: Removing leading `/&#39; from member names</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span><span style="color:#999;font-style:italic">#cpio: dev/console: Cannot mknod: Operation not permitted</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span><span style="color:#999;font-style:italic">#cpio: dev/mem: Cannot mknod: Operation not permitted</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span><span style="color:#999;font-style:italic">#cpio: dev/ptmx: Cannot mknod: Operation not permitted</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span><span style="color:#999;font-style:italic">#cpio: dev/null: Cannot mknod: Operation not permitted</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span><span style="color:#999;font-style:italic"># (...)</span>
</code></pre></div><div class="alert alert-info"><span><i class="fas fa-info-circle"></i>&nbsp;</span>There will be some errors reproducing the <code>/dev</code>, <code>/proc</code> and <code>/sys</code> directories but those can be ignored.</div>
<p>And that&rsquo;s it, the running access point file system is ready to go under the microscope :)</p></div>
      </div>
      <div class="card-footer">
<span><i class="fas fa-calendar-alt"></i>&nbsp;</span>October 21, 2015&nbsp;&nbsp;<br/>
<span><i class="fas fa-folder-open"></i>&nbsp;</span><a href="https://www.serializing.me/categories/bug-bounty/">Bug Bounty</a>,&nbsp;<a href="https://www.serializing.me/categories/linux/">Linux</a>,&nbsp;<a href="https://www.serializing.me/categories/reverse-engineering/">Reverse Engineering</a>&nbsp;&nbsp;<br/>
<span><i class="fas fa-tag"></i>&nbsp;</span><a href="https://www.serializing.me/tags/aruba-networks/">Aruba Networks</a>,&nbsp;<a href="https://www.serializing.me/tags/bugcrowd/">Bugcrowd</a>
      </div>
    </div>
    <ul class="pagination justify-content-center mb-4"><li class="page-item">
        <a href="https://www.serializing.me/2015/11/01/inspecting-applocker-policy/" title="Inspecting AppLocker Policy" class="page-link"><span><i class="fas fa-chevron-left"></i>&nbsp;</span>Newer</a>
      </li><li class="page-item">
    <a href="https://www.serializing.me/2015/08/12/ssh-brute-force-and-suricata/" title="SSH Brute Force and Suricata" class="page-link">Older<span>&nbsp;<i class="fas fa-chevron-right"></i>&nbsp;</span></a>
  </li></ul>
  </div>
  
  <div class="col-md-4">
    
    <div class="card my-4">
      <h5 class="card-header">Categories</h5>
      <div class="card-body">
        <div class="cloud">
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/bug-bounty/" title="3 posts">bug-bounty</a>
<a style="font-size: 1.2307692307692308em" href="https://www.serializing.me/categories/case-study/" title="4 posts">case-study</a>
<a style="font-size: 1.5384615384615385em" href="https://www.serializing.me/categories/configuration/" title="8 posts">configuration</a>
<a style="font-size: 1.0769230769230769em" href="https://www.serializing.me/categories/cve/" title="2 posts">cve</a>
<a style="font-size: 1em" href="https://www.serializing.me/categories/encryption/" title="1 posts">encryption</a>
<a style="font-size: 1.3076923076923077em" href="https://www.serializing.me/categories/exploit/" title="5 posts">exploit</a>
<a style="font-size: 1.2307692307692308em" href="https://www.serializing.me/categories/hardware-hacking/" title="4 posts">hardware-hacking</a>
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/incident-response/" title="3 posts">incident-response</a>
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/learning/" title="3 posts">learning</a>
<a style="font-size: 1.8461538461538463em" href="https://www.serializing.me/categories/linux/" title="12 posts">linux</a>
<a style="font-size: 1.3076923076923077em" href="https://www.serializing.me/categories/malware/" title="5 posts">malware</a>
<a style="font-size: 1em" href="https://www.serializing.me/categories/memory-forensics/" title="1 posts">memory-forensics</a>
<a style="font-size: 1.5384615384615385em" href="https://www.serializing.me/categories/network/" title="8 posts">network</a>
<a style="font-size: 1.1538461538461537em" href="https://www.serializing.me/categories/reconnaissance/" title="3 posts">reconnaissance</a>
<a style="font-size: 1.9230769230769231em" href="https://www.serializing.me/categories/reverse-engineering/" title="13 posts">reverse-engineering</a>
<a style="font-size: 1.2307692307692308em" href="https://www.serializing.me/categories/virtualization/" title="4 posts">virtualization</a>
<a style="font-size: 2em" href="https://www.serializing.me/categories/windows/" title="14 posts">windows</a>


        </div>
      </div>
    </div>
    
    <div class="card my-4">
      <h5 class="card-header">Tags</h5>
      <div class="card-body">
        <div class="cloud">
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/active-directory/" title="3 posts">active-directory</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/acunetix-wvs/" title="1 posts">acunetix-wvs</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/android/" title="1 posts">android</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/applocker/" title="2 posts">applocker</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/aruba-networks/" title="2 posts">aruba-networks</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/attck/" title="1 posts">attck</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/banking/" title="1 posts">banking</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/bios/" title="1 posts">bios</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/brute-force/" title="1 posts">brute-force</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/bugcrowd/" title="3 posts">bugcrowd</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/cac-ipc/" title="3 posts">cac-ipc</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/cheat/" title="1 posts">cheat</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/cisco-anyconnect/" title="3 posts">cisco-anyconnect</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/code-injection/" title="1 posts">code-injection</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/csharp/" title="1 posts">csharp</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/cuckoo-sandbox/" title="2 posts">cuckoo-sandbox</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/e-gpu/" title="1 posts">e-gpu</a>
<a style="font-size: 1.75em" href="https://www.serializing.me/tags/emofishes/" title="4 posts">emofishes</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/emotions/" title="3 posts">emotions</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/fireeye/" title="3 posts">fireeye</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/gpo-bypass/" title="1 posts">gpo-bypass</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/group-policy-objects/" title="1 posts">group-policy-objects</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/honeypot/" title="1 posts">honeypot</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hook-functions/" title="1 posts">hook-functions</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hp/" title="1 posts">hp</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hpqpswdd/" title="1 posts">hpqpswdd</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/hugo/" title="1 posts">hugo</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/ivre/" title="1 posts">ivre</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/lemp/" title="2 posts">lemp</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/metasploit/" title="1 posts">metasploit</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/paranoid-fish/" title="3 posts">paranoid-fish</a>
<a style="font-size: 1.75em" href="https://www.serializing.me/tags/passwords/" title="4 posts">passwords</a>
<a style="font-size: 1.25em" href="https://www.serializing.me/tags/portuguese/" title="2 posts">portuguese</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/powascripts/" title="3 posts">powascripts</a>
<a style="font-size: 1.75em" href="https://www.serializing.me/tags/powershell/" title="4 posts">powershell</a>
<a style="font-size: 2em" href="https://www.serializing.me/tags/qemu/" title="5 posts">qemu</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/raspberry-pi/" title="1 posts">raspberry-pi</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/razer/" title="1 posts">razer</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/red-team/" title="1 posts">red-team</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/soho/" title="3 posts">soho</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/ssh/" title="1 posts">ssh</a>
<a style="font-size: 2em" href="https://www.serializing.me/tags/suricata/" title="5 posts">suricata</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/technicolor/" title="3 posts">technicolor</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/titan-quest/" title="1 posts">titan-quest</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/tls/" title="1 posts">tls</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/tq-invincible/" title="1 posts">tq-invincible</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/usb/" title="1 posts">usb</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/virtualbox/" title="3 posts">virtualbox</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/volatility/" title="1 posts">volatility</a>
<a style="font-size: 1.5em" href="https://www.serializing.me/tags/wordpress/" title="3 posts">wordpress</a>
<a style="font-size: 1em" href="https://www.serializing.me/tags/yara/" title="1 posts">yara</a>


        </div>
      </div>
    </div>
  </div>
</div>



    </section>
    <footer class="mt-4 bg-dark">
<div class="container">
  <div class="row text-center">
  <div class="col-12 col-md my-4">
    <ul class="list-inline">

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://infosec.exchange/@serializingme" title="Mastodon">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-mastodon fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://www.twitch.tv/serializingme" title="Twitch">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-twitch fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://discord.gg/NS5qHT4" title="Discord">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-discord fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://www.youtube.com/serializingme" title="YouTube">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-youtube fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://github.com/serializingme" title="GitHub">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-github fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://bugcrowd.com/serializingme" title="Bugcrowd">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fas fa-bug fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

      <li class="list-inline-item">
        <a rel="me" class="footer-link text-light" href="https://twitter.com/serializingme" title="Twitter">
          <span class="fa-stack fa-lg">
            <i class="fas fa-square fa-stack-2x text-light"></i>
            <i class="fab fa-twitter fa-stack-1x text-secondary"></i>
          </span>
        </a>
      </li>

    </ul>
      <ul class="list-inline">

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-copyright"></i>&nbsp;</span><a class="footer-link text-light" href="/licensing/" title="Licensing">Licensing</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-eye"></i>&nbsp;</span><a class="footer-link text-light" href="/privacy/" title="Privacy">Privacy</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-shield-alt"></i>&nbsp;</span><a class="footer-link text-light" href="/security/" title="Security">Security</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-envelope"></i>&nbsp;</span><a class="footer-link text-light" href="/contacts/" title="Contacts">Contacts</a>
    </li>

    <li class="list-inline-item">
      <span class="fa-lg text-secondary"><i class="fas fa-rss"></i>&nbsp;</span><a class="footer-link text-light" href="/feeds/" title="Feeds">Feeds</a>
    </li>

  </ul>
  <small class="d-block mb-3 text-muted">&copy;&nbsp;2023&nbsp;Duarte Silva</small>
  </div>
</div>
</div>

    </footer>
<script src="https://www.serializing.me/js/jquery.min.js"></script>
<script src="https://www.serializing.me/js/bootstrap.min.js"></script>
<script src="https://www.serializing.me/js/fontawesome-solid.min.js"></script>
<script src="https://www.serializing.me/js/fontawesome-brands.min.js"></script>
<script src="https://www.serializing.me/js/fontawesome.min.js"></script><script src="https://www.serializing.me/js/serializingme.min.js"></script>
  </body>
</html>
